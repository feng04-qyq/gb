# 自动登录系统

## 功能概述

自动登录系统允许用户手动设置账号密码，系统将每天自动使用这些凭据登录一次，确保账号的日常签到和提现操作能够正常进行。

## 主要特性

### 1. 手动设置凭据
- 用户需要手动输入账号和密码来配置自动登录
- 系统会验证账号密码的有效性
- 凭据安全存储在本地配置文件中

### 2. 智能登录判断
- 系统记录上次登录日期
- 每天只自动登录一次
- 避免重复登录和资源浪费

### 3. 灵活控制
- 可以随时启用/禁用自动登录功能
- 可以清除保存的登录凭据
- 支持重新设置新的凭据

## 技术实现

### 核心模块

#### `auto_login_manager.py`
自动登录管理器，负责：
- 凭据的保存和读取
- 登录状态的判断
- 配置的管理

#### 主要方法
```python
# 设置自动登录凭据
set_auto_login_credentials(account, password)

# 获取登录凭据
get_login_credentials()

# 判断是否应该自动登录
should_auto_login()

# 更新最后登录日期
update_last_login_date()

# 启用/禁用自动登录
enable_auto_login()
disable_auto_login()

# 清除凭据
clear_credentials()
```

### Web API接口

#### 1. 获取自动登录状态
```
GET /api/auto_login_status
```
返回当前自动登录的配置状态。

#### 2. 设置自动登录凭据
```
POST /api/set_auto_login_credentials
Content-Type: application/json

{
    "account": "用户账号",
    "password": "用户密码"
}
```
设置用于自动登录的账号密码，系统会验证凭据的有效性。

#### 3. 控制自动登录
```
POST /api/auto_login_control
Content-Type: application/json

{
    "action": "enable|disable|clear"
}
```
- `enable`: 启用自动登录
- `disable`: 禁用自动登录
- `clear`: 清除保存的凭据

## 使用流程

### 1. 设置自动登录凭据
1. 登录系统后，在"自动登录状态"卡片中点击"设置凭据"
2. 在弹出的表单中输入账号和密码
3. 系统会验证账号密码的有效性
4. 验证成功后，凭据会被保存

### 2. 启用自动登录
1. 设置凭据后，点击"启用"按钮
2. 系统会启用自动登录功能
3. 每天第一次访问时会自动登录

### 3. 管理自动登录
- **禁用**: 点击"禁用"按钮可以暂时关闭自动登录
- **清除**: 点击"清除"按钮可以删除保存的凭据
- **重新设置**: 可以随时重新设置新的凭据

## 配置文件

### `auto_login_config.json`
```json
{
    "enabled": true,
    "account": "用户账号",
    "password": "用户密码",
    "last_login_date": "2024-01-01",
    "auto_login_enabled": true
}
```

## 安全考虑

1. **凭据验证**: 设置凭据时会验证账号密码的有效性
2. **本地存储**: 凭据只存储在本地，不会上传到服务器
3. **访问控制**: 只有登录用户才能设置和管理自动登录
4. **日志记录**: 所有自动登录操作都会记录在日志中

## 错误处理

### 常见错误
1. **凭据无效**: 账号密码验证失败
2. **网络错误**: 无法连接到目标服务器
3. **配置错误**: 配置文件损坏或权限不足

### 错误恢复
- 系统会自动重试失败的登录
- 可以手动清除凭据重新设置
- 支持禁用自动登录功能

## 测试

运行测试脚本验证功能：
```bash
python test_auto_login.py
```

测试内容包括：
- 凭据设置和验证
- 自动登录状态管理
- Web API接口测试
- 错误处理测试

## 注意事项

1. **凭据安全**: 请确保凭据的安全性，不要在不安全的环境中设置
2. **网络环境**: 自动登录需要稳定的网络环境
3. **账号状态**: 确保账号没有被封禁或限制
4. **定期检查**: 建议定期检查自动登录的状态和日志

## 更新日志

### v2.0 (当前版本)
- 改为手动设置凭据，不再自动保存首次登录信息
- 添加凭据验证功能
- 优化用户界面和交互体验
- 增强错误处理和状态显示

### v1.0
- 自动保存首次登录凭据
- 基本的自动登录功能
- 简单的启用/禁用控制 